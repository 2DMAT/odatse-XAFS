<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Input and output &#8212; ODAT-SE solver module: odatse-XAFS for PTRF-XAFS 1.0.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/haiku.css?v=fce32b03" />
    <script src="_static/documentation_options.js?v=8d563738"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Acknowledgements" href="acknowledgement.html" />
    <link rel="prev" title="Analyses by user programs" href="tutorial/user_program.html" /> 
  </head><body>
      <div class="header" role="banner"><h1 class="heading"><a href="index.html">
          <span>ODAT-SE solver module: odatse-XAFS for PTRF-XAFS 1.0.0 documentation</span></a></h1>
        <h2 class="heading"><span>Input and output</span></h2>
      </div>
      <div class="topnav" role="navigation" aria-label="Top">
      
        <p>
        «&#160;&#160;<a href="tutorial/user_program.html">Analyses by user programs</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="acknowledgement.html">Acknowledgements</a>&#160;&#160;»
        </p>

      </div>
      <div class="content" role="main">
        
        
  <section id="input-and-output">
<h1>Input and output<a class="headerlink" href="#input-and-output" title="Link to this heading">¶</a></h1>
<p>odatse-XAFS module is a <code class="docutils literal notranslate"><span class="pre">Solver</span></code> package that uses FEFF to calculate X-ray absorption spectra from the atomic position <span class="math notranslate nohighlight">\(x\)</span> and returns the deviation from the experimental XAFS spectra as <span class="math notranslate nohighlight">\(f(x)\)</span>.</p>
<p>In this section, the input parameters, the input data, and the output data are explained.
The input parameters are taken from the <code class="docutils literal notranslate"><span class="pre">solver</span></code> entry of the <code class="docutils literal notranslate"><span class="pre">Info</span></code> class.
The parameters are specified in <code class="docutils literal notranslate"><span class="pre">[solver]</span></code> section when they are given from a TOML file.
If the parameters are given in the dictionary format, they should be prepared as a nested dict under the <code class="docutils literal notranslate"><span class="pre">solver</span></code> key.
In the following, the parameter items are described in the TOML format.</p>
<p>The input data consist of target reference data, and templates of the input file for FEFF.
The output data are the output files and log files generated by <code class="docutils literal notranslate"><span class="pre">feff85L</span></code> of FEFF.
Their contents will be shown in this section.</p>
<section id="input-parameters">
<h2>Input parameters<a class="headerlink" href="#input-parameters" title="Link to this heading">¶</a></h2>
<p>Input parameters can be specified in the subsections <code class="docutils literal notranslate"><span class="pre">config</span></code>, <code class="docutils literal notranslate"><span class="pre">param</span></code>, <code class="docutils literal notranslate"><span class="pre">reference</span></code> in <code class="docutils literal notranslate"><span class="pre">solver</span></code> section.</p>
<section id="solver-section">
<h3>[<code class="docutils literal notranslate"><span class="pre">solver</span></code>] section<a class="headerlink" href="#solver-section" title="Link to this heading">¶</a></h3>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">dimension</span></code></p>
<p>Format: integer</p>
<p>Description:
Number of parameters. It must be specified either in the solver section of in the base section. When both specified, the value in the solver section is used.
The value should be equal to the length of <code class="docutils literal notranslate"><span class="pre">string_list</span></code>.</p>
</li>
</ul>
</section>
<section id="solver-config-subsection">
<h3>[<code class="docutils literal notranslate"><span class="pre">solver.config</span></code>] subsection<a class="headerlink" href="#solver-config-subsection" title="Link to this heading">¶</a></h3>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">feff_exec_file</span></code></p>
<p>Format: string (default: “feff85L”)</p>
<p>Description: Path to FEFF solver.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">feff_input_file</span></code></p>
<p>Format: string (default: “feff.inp”)</p>
<p>Description: Input file for FEFF solver. For <code class="docutils literal notranslate"><span class="pre">feff85L</span></code>, it is fixed to <code class="docutils literal notranslate"><span class="pre">feff.inp</span></code>.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">feff_output_file</span></code></p>
<p>Format: string (default: “chi.dat”)</p>
<p>Description: Output file for X-ray absorption spectrum among FEFF output files. For <code class="docutils literal notranslate"><span class="pre">feff85L</span></code>, it is fixed to <code class="docutils literal notranslate"><span class="pre">chi.dat</span></code>.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">feff_template_file</span></code></p>
<p>Format: string (default: “template.txt”)</p>
<p>Description: Template for the input file of FEFF.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">remove_work_dir</span></code></p>
<p>Format: boolean (default: false)</p>
<p>Description: If it is set to true, the work directories <code class="docutils literal notranslate"><span class="pre">Log%%%%_####</span></code> will be removed after the calculation.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">use_tmpdir</span></code></p>
<p>Format: boolean (default: false)</p>
<p>Description: If it is set to true, the output files of FEFF will be written in a temporary directory in /tmp (or in the directory specified by the environment variable <code class="docutils literal notranslate"><span class="pre">TMPDIR</span></code>). It is automatically removed after the calculation.</p>
</li>
</ul>
</section>
<section id="solver-param-subsection">
<h3>[<code class="docutils literal notranslate"><span class="pre">solver.param</span></code>] subsection<a class="headerlink" href="#solver-param-subsection" title="Link to this heading">¶</a></h3>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">string_list</span></code></p>
<p>Format: list of strings. The length should match the value of dimension (default: [“value_01”, “value_02”]).</p>
<p>Description: List of placeholders to be used in the reference template file to create the input file for the solver. These strings will be replaced with the values of the parameters being searched for.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">polarization_list</span></code></p>
<p>Format: list that consists of three strings.</p>
<p>Description: List of placeholders for the polarization vector to be used in the reference template file.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">polarization</span></code></p>
<p>Format: list of lists that consist of three floats.</p>
<p>Description: List of polarization vectors.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">calculated_first_k</span></code></p>
<p>Format: float</p>
<p>Description: Lower end of the range of wave length in which the calculated values and the experimental data are compared.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">calculated_last_k</span></code></p>
<p>Format: float</p>
<p>Description: Upper end of the range of wave length in which the calculated values and the experimental data are compared.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">k_range</span></code></p>
<p>Format: list of floats</p>
<p>Description: The range of wave length specified by a list in the form [lower value, upper value] in which the calculated values and the experimental data are compared. This parameter and the pair of parameters <code class="docutils literal notranslate"><span class="pre">calculated_first_k</span></code> and <code class="docutils literal notranslate"><span class="pre">calculated_last_k</span></code> are exclusive, and either one should be specified.</p>
</li>
</ul>
</section>
<section id="solver-reference-subsection">
<h3>[<code class="docutils literal notranslate"><span class="pre">solver.reference</span></code>] subsection<a class="headerlink" href="#solver-reference-subsection" title="Link to this heading">¶</a></h3>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">path_epsilon</span></code></p>
<p>Format: string</p>
<p>Description: Path to the reference data file.</p>
</li>
</ul>
</section>
</section>
<section id="reference-files">
<h2>Reference files<a class="headerlink" href="#reference-files" title="Link to this heading">¶</a></h2>
<section id="input-template-file">
<h3>Input template file<a class="headerlink" href="#input-template-file" title="Link to this heading">¶</a></h3>
<p>The input template file <code class="docutils literal notranslate"><span class="pre">template.txt</span></code> is a template for creating an input file for <code class="docutils literal notranslate"><span class="pre">feff85L</span></code>.
The parameters to be varied in odatse-XAFS (such as the atomic coordinates you want to find) should be replaced with the appropriate string, such as <code class="docutils literal notranslate"><span class="pre">value_*</span></code>.
The strings to be used are specified by <code class="docutils literal notranslate"><span class="pre">string_list</span></code> in the <code class="docutils literal notranslate"><span class="pre">[solver.param]</span></code> section of the input file for the solver.
Similarly, the elements of the polarization vector are replaced by the strings such as <code class="docutils literal notranslate"><span class="pre">polarization_*</span></code> specified by the <code class="docutils literal notranslate"><span class="pre">polarization_list</span></code> parameter.</p>
<p>An example template is shown below.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">*</span> <span class="n">This</span> <span class="n">feff</span><span class="o">.</span><span class="n">inp</span> <span class="n">file</span> <span class="n">generated</span> <span class="n">by</span> <span class="n">ATOMS</span><span class="p">,</span> <span class="n">version</span> <span class="mf">2.50</span>
<span class="o">*</span> <span class="n">ATOMS</span> <span class="n">written</span> <span class="n">by</span> <span class="ow">and</span> <span class="n">copyright</span> <span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="n">Bruce</span> <span class="n">Ravel</span><span class="p">,</span> <span class="mi">1992</span><span class="o">-</span><span class="mi">1999</span>

<span class="o">*</span> <span class="o">--</span> <span class="o">*</span> <span class="o">--</span> <span class="o">*</span> <span class="o">--</span> <span class="o">*</span> <span class="o">--</span> <span class="o">*</span> <span class="o">--</span> <span class="o">*</span> <span class="o">--</span> <span class="o">*</span> <span class="o">--</span> <span class="o">*</span> <span class="o">--</span> <span class="o">*</span> <span class="o">--</span> <span class="o">*</span> <span class="o">--</span> <span class="o">*</span> <span class="o">--</span> <span class="o">*</span> <span class="o">--</span> <span class="o">*</span> <span class="o">--</span> <span class="o">*</span> <span class="o">--</span> <span class="o">*</span>
<span class="o">*</span>       <span class="n">total</span> <span class="n">mu</span> <span class="o">=</span>      <span class="mf">725.4</span> <span class="n">cm</span><span class="o">^-</span><span class="mi">1</span><span class="p">,</span> <span class="n">delta</span> <span class="n">mu</span> <span class="o">=</span>      <span class="mf">610.0</span> <span class="n">cm</span><span class="o">^-</span><span class="mi">1</span>
<span class="o">*</span>       <span class="n">specific</span> <span class="n">gravity</span> <span class="o">=</span> <span class="mf">12.006</span><span class="p">,</span> <span class="n">cluster</span> <span class="n">contains</span>   <span class="mi">55</span> <span class="n">atoms</span><span class="o">.</span>
<span class="o">*</span> <span class="o">--</span> <span class="o">*</span> <span class="o">--</span> <span class="o">*</span> <span class="o">--</span> <span class="o">*</span> <span class="o">--</span> <span class="o">*</span> <span class="o">--</span> <span class="o">*</span> <span class="o">--</span> <span class="o">*</span> <span class="o">--</span> <span class="o">*</span> <span class="o">--</span> <span class="o">*</span> <span class="o">--</span> <span class="o">*</span> <span class="o">--</span> <span class="o">*</span> <span class="o">--</span> <span class="o">*</span> <span class="o">--</span> <span class="o">*</span> <span class="o">--</span> <span class="o">*</span> <span class="o">--</span> <span class="o">*</span>
<span class="o">*</span>       <span class="n">mcmaster</span> <span class="n">corrections</span><span class="p">:</span>  <span class="mf">0.00020</span> <span class="n">ang</span><span class="o">^</span><span class="mi">2</span> <span class="ow">and</span>  <span class="mf">0.770E-07</span> <span class="n">ang</span><span class="o">^</span><span class="mi">4</span>
<span class="o">*</span> <span class="o">--</span> <span class="o">*</span> <span class="o">--</span> <span class="o">*</span> <span class="o">--</span> <span class="o">*</span> <span class="o">--</span> <span class="o">*</span> <span class="o">--</span> <span class="o">*</span> <span class="o">--</span> <span class="o">*</span> <span class="o">--</span> <span class="o">*</span> <span class="o">--</span> <span class="o">*</span> <span class="o">--</span> <span class="o">*</span> <span class="o">--</span> <span class="o">*</span> <span class="o">--</span> <span class="o">*</span> <span class="o">--</span> <span class="o">*</span> <span class="o">--</span> <span class="o">*</span> <span class="o">--</span> <span class="o">*</span>

<span class="n">TITLE</span>   <span class="n">Sample_data</span>

<span class="n">EDGE</span>      <span class="n">K</span>
<span class="n">S02</span>       <span class="mf">1.0</span>

<span class="o">*</span>         <span class="n">pot</span>    <span class="n">xsph</span>  <span class="n">fms</span>   <span class="n">paths</span> <span class="n">genfmt</span> <span class="n">ff2chi</span>
<span class="n">CONTROL</span>   <span class="mi">1</span>      <span class="mi">1</span>      <span class="mi">1</span>      <span class="mi">1</span>      <span class="mi">1</span>      <span class="mi">1</span>
<span class="n">PRINT</span>     <span class="mi">0</span>      <span class="mi">0</span>      <span class="mi">0</span>      <span class="mi">0</span>      <span class="mi">0</span>      <span class="mi">0</span>

<span class="o">*</span>         <span class="n">r_scf</span>   <span class="p">[</span> <span class="n">l_scf</span>  <span class="n">n_scf</span>  <span class="n">ca</span> <span class="p">]</span>
<span class="o">*</span><span class="n">SCF</span>       <span class="mf">6.05142</span>     <span class="mi">0</span>     <span class="mi">15</span>     <span class="mf">0.1</span>


<span class="n">EXAFS</span>    <span class="mi">20</span>
<span class="n">RPATH</span>    <span class="mi">6</span>

<span class="o">*</span>         <span class="n">kmax</span>  <span class="p">[</span> <span class="n">delta_k</span>  <span class="n">delta_e</span> <span class="p">]</span>
<span class="o">*</span><span class="n">XANES</span>     <span class="mf">4.0</span>     <span class="mf">0.07</span>     <span class="mf">0.5</span>
<span class="o">*</span>         <span class="n">r_fms</span>     <span class="p">[</span> <span class="n">l_fms</span> <span class="p">]</span>
<span class="o">*</span><span class="n">FMS</span>       <span class="mf">6.05142</span>    <span class="mi">0</span>
<span class="o">*</span>
<span class="o">*</span><span class="n">RPATH</span>     <span class="mf">0.10000</span>
<span class="o">*</span>         <span class="n">emin</span>  <span class="n">emax</span>  <span class="n">resolution</span>
<span class="o">*</span><span class="n">LDOS</span>      <span class="o">-</span><span class="mi">20</span>    <span class="mi">20</span>   <span class="mf">0.1</span>


<span class="n">POTENTIALS</span>
<span class="o">*</span>   <span class="n">ipot</span>   <span class="n">z</span> <span class="p">[</span> <span class="n">label</span>   <span class="n">l_scmt</span>  <span class="n">l_fms</span>  <span class="n">stoichiometry</span> <span class="p">]</span>
      <span class="mi">0</span>   <span class="mi">28</span>    <span class="n">Ni</span>
      <span class="mi">1</span>   <span class="mi">16</span>    <span class="n">S</span>
      <span class="mi">2</span>    <span class="mi">8</span>     <span class="n">O</span>
<span class="n">NLEG</span>         <span class="mi">2</span>

<span class="o">*</span><span class="n">CRITERIA</span>     <span class="mf">4.00</span>     <span class="mf">2.50</span>

<span class="o">*</span><span class="n">DEBYE</span>        <span class="mf">300.00</span>   <span class="mf">340.00</span>

<span class="o">*</span> <span class="n">CORRECTION</span> <span class="mf">4.50</span> <span class="mf">0.5</span>
<span class="o">*</span> <span class="n">RMULTIPLIER</span> <span class="mf">1.00</span>
<span class="o">*</span> <span class="n">ION</span> <span class="mi">0</span> <span class="mf">0.2</span>
<span class="o">*</span> <span class="n">ION</span> <span class="mi">1</span> <span class="mf">0.2</span>

<span class="o">*</span>         <span class="n">ixc</span>  <span class="p">[</span> <span class="n">Vr</span>  <span class="n">Vi</span> <span class="p">]</span>
<span class="n">EXCHANGE</span>  <span class="mi">0</span>    <span class="o">-</span><span class="mi">5</span>    <span class="mi">0</span>
<span class="n">SIG2</span>  <span class="mf">0.0016</span>
<span class="n">POLARIZATION</span>   <span class="n">polarization_01</span> <span class="n">polarization_02</span> <span class="n">polarization_03</span>

<span class="n">ATOMS</span>
<span class="mf">0.0000</span> <span class="mf">0.0000</span> <span class="mf">0.0000</span> <span class="mi">0</span> <span class="n">Ni</span>
<span class="n">value_01</span> <span class="n">value_02</span> <span class="n">value_03</span> <span class="mi">1</span> <span class="n">S</span>
<span class="mf">1.1400</span> <span class="mf">1.2800</span> <span class="mf">0.9700</span> <span class="mi">2</span> <span class="n">O</span>
</pre></div>
</div>
<p>In this case, <code class="docutils literal notranslate"><span class="pre">value_01</span></code>, <code class="docutils literal notranslate"><span class="pre">value_02</span></code>, and <code class="docutils literal notranslate"><span class="pre">value_03</span></code> are the parameters to be varied, and <code class="docutils literal notranslate"><span class="pre">polarization_01</span></code>, <code class="docutils literal notranslate"><span class="pre">polarization_02</span></code>, and <code class="docutils literal notranslate"><span class="pre">polarization_03</span></code> are the elements of the polarization vector.</p>
<p>See the FEFF reference manual for the format of the input file.</p>
</section>
<section id="target-file">
<h3>Target file<a class="headerlink" href="#target-file" title="Link to this heading">¶</a></h3>
<p>The target file that contains experimental data is specified by the <code class="docutils literal notranslate"><span class="pre">path_epsilon</span></code> parameter in the <code class="docutils literal notranslate"><span class="pre">[solver.reference]</span></code> section.
The format of the data is as follows:
The first column contains the wave number, and the second and latter columns contain the spectrum intensity and its uncertainty for each polarization direction.
The first two lines correspond to the header.</p>
<p>An example of the file is shown below.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">k</span>    <span class="n">c</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="n">_E</span><span class="p">[</span><span class="mi">001</span><span class="p">]</span>
<span class="p">(</span><span class="n">Ni09sum000</span><span class="o">-</span><span class="mi">004</span><span class="n">k</span>    <span class="n">e</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="n">_E</span><span class="p">[</span><span class="mi">001</span><span class="p">]</span>             <span class="n">Ni11sum000</span><span class="o">-</span><span class="mi">004</span><span class="n">k_sum140521_E1</span>    <span class="n">e</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="n">_E</span><span class="p">[</span><span class="mi">1</span><span class="o">-</span><span class="mi">10</span><span class="p">]</span>            <span class="n">Ni13dd_sum000</span><span class="o">-</span><span class="mi">004</span><span class="n">k_d140617_t</span>    <span class="n">e</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="n">_E</span><span class="p">[</span><span class="mi">110</span><span class="p">]</span>
<span class="mf">3.5</span>           <span class="o">-</span><span class="mf">0.02335000</span>             <span class="mf">0.006999908</span>                     <span class="o">-</span><span class="mf">0.04765000</span>             <span class="mf">0.007511923</span>                     <span class="o">-</span><span class="mf">0.04365000</span>             <span class="mf">0.007200607</span>
<span class="mf">3.55</span>          <span class="o">-</span><span class="mf">0.01203000</span>             <span class="mf">0.009141367</span>                     <span class="o">-</span><span class="mf">0.03033000</span>             <span class="mf">0.010077591</span>                     <span class="o">-</span><span class="mf">0.03322000</span>             <span class="mf">0.009255752</span>
<span class="mf">3.6</span>           <span class="o">-</span><span class="mf">0.00198000</span>             <span class="mf">0.008535745</span>                     <span class="o">-</span><span class="mf">0.02501000</span>             <span class="mf">0.008242841</span>                     <span class="o">-</span><span class="mf">0.02414000</span>             <span class="mf">0.007907668</span>
<span class="o">...</span>
</pre></div>
</div>
</section>
</section>
<section id="output-files">
<h2>Output files<a class="headerlink" href="#output-files" title="Link to this heading">¶</a></h2>
<p>For odatse-XAFS, the files generated by <code class="docutils literal notranslate"><span class="pre">feff85L</span></code> will be written in <code class="docutils literal notranslate"><span class="pre">call_01</span></code>, <code class="docutils literal notranslate"><span class="pre">call_02</span></code>, and <code class="docutils literal notranslate"><span class="pre">call_03</span></code> in <code class="docutils literal notranslate"><span class="pre">Log%%%%%_#####</span></code> created under the folder with the rank number.
(When <code class="docutils literal notranslate"><span class="pre">use_tmpdir</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, they are stored in <code class="docutils literal notranslate"><span class="pre">/tmp</span></code> or in a temporary directory specified by the environment variable <code class="docutils literal notranslate"><span class="pre">TMPDIR</span></code>.)
<code class="docutils literal notranslate"><span class="pre">%%%%%</span></code> stands for the index of iteration in <code class="docutils literal notranslate"><span class="pre">Algorithm</span></code> (e.g., steps in Monte Carlo),
<code class="docutils literal notranslate"><span class="pre">#####</span></code> stands for the index of group (e.g., replica index in Monte Carlo), and
<code class="docutils literal notranslate"><span class="pre">call_01</span></code>, …, are the labels for the polarization directions.</p>
<p>In large calculations, the number of files generated during the execution may</p>
<p>In large-scale calculations, the number of files generated during the execution may become huge and reach to the limitation of storage systems.
For such cases, let the <code class="docutils literal notranslate"><span class="pre">solver.config.remove_work_dir</span></code> parameter be <code class="docutils literal notranslate"><span class="pre">true</span></code> in order to remove these folders.</p>
</section>
</section>


      </div>
      <div class="bottomnav" role="navigation" aria-label="Bottom">
      
        <p>
        «&#160;&#160;<a href="tutorial/user_program.html">Analyses by user programs</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="acknowledgement.html">Acknowledgements</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer" role="contentinfo">
    &#169; Copyright 2024-, Institute for Solid State Physics, University of Tokyo.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    </div>
  </body>
</html>